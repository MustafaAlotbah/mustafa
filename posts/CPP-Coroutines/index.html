<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="C++20 - Coroutines" />
<meta property="og:locale" content="en" />
<meta name="description" content="Coroutines, introduced in C++20, bring a powerful mechanism for handling asynchronous operations, generators and cooperative multitasking. Unlike conventional functions, which execute sequentially from start to return, coroutines are functions that can suspend and resume execution at specific points, effectively allowing you to pause execution, yield results, and return control to the caller without fully exiting the function." />
<meta property="og:description" content="Coroutines, introduced in C++20, bring a powerful mechanism for handling asynchronous operations, generators and cooperative multitasking. Unlike conventional functions, which execute sequentially from start to return, coroutines are functions that can suspend and resume execution at specific points, effectively allowing you to pause execution, yield results, and return control to the caller without fully exiting the function." />
<link rel="canonical" href="http://localhost:4000/posts/CPP-Coroutines/" />
<meta property="og:url" content="http://localhost:4000/posts/CPP-Coroutines/" />
<meta property="og:site_name" content="Mustafa Alotbahâ€™s Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-01-22T21:34:00+01:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="C++20 - Coroutines" />
<meta name="twitter:site" content="@" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-01-22T21:34:00+01:00","datePublished":"2024-01-22T21:34:00+01:00","description":"Coroutines, introduced in C++20, bring a powerful mechanism for handling asynchronous operations, generators and cooperative multitasking. Unlike conventional functions, which execute sequentially from start to return, coroutines are functions that can suspend and resume execution at specific points, effectively allowing you to pause execution, yield results, and return control to the caller without fully exiting the function.","headline":"C++20 - Coroutines","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/CPP-Coroutines/"},"url":"http://localhost:4000/posts/CPP-Coroutines/"}</script>
<!-- End Jekyll SEO tag -->


  <title>C++20 - Coroutines | Mustafa Alotbah's Blog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Mustafa Alotbah's Blog">
<meta name="application-name" content="Mustafa Alotbah's Blog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.2/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.27.20/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- JavaScript -->

  
    <!-- Switch the mode between dark and light. -->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() {
      return 'mode';
    }
    static get MODE_ATTR() {
      return 'data-mode';
    }
    static get DARK_MODE() {
      return 'dark';
    }
    static get LIGHT_MODE() {
      return 'light';
    }
    static get ID() {
      return 'mode-toggle';
    }

    constructor() {
      let self = this;this.sysDarkPrefers.addEventListener('change', () => {
        if (self.hasMode) {
          self.clearMode();
        }
        self.notify();
      });

      if (!this.hasMode) {
        return;
      }

      if (this.isDarkMode) {
        this.setDark();
      } else {
        this.setLight();
      }
    }

    get sysDarkPrefers() {
      return window.matchMedia('(prefers-color-scheme: dark)');
    }

    get isPreferDark() {
      return this.sysDarkPrefers.matches;
    }

    get isDarkMode() {
      return this.mode === ModeToggle.DARK_MODE;
    }

    get hasMode() {
      return this.mode != null;
    }

    get mode() {
      return sessionStorage.getItem(ModeToggle.MODE_KEY);
    }get modeStatus() {
      if (this.hasMode) {
        return this.mode;
      } else {
        return this.isPreferDark ? ModeToggle.DARK_MODE : ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      document.documentElement.removeAttribute(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }notify() {
      window.postMessage(
        {
          direction: ModeToggle.ID,
          message: this.modeStatus
        },
        '*'
      );
    }

    flipMode() {
      if (this.hasMode) {
        this.clearMode();
      } else {
        if (this.isPreferDark) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.notify();
    }
  }

  const modeToggle = new ModeToggle();
</script>

  

  <!-- A placeholder to allow defining custom metadata -->





<!-- Link to the GitHub Dark theme stylesheet -->
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css">
<!-- <link rel="stylesheet" href="path/to/your/custom-styles.css"> -->
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>

<!-- Include the Line Numbers Plugin JavaScript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>


<!-- Initialize Highlight.js -->
<script>
  document.addEventListener('DOMContentLoaded', (event) => {
    hljs.highlightAll();
    hljs.initLineNumbersOnLoad();
  });
</script>

<!-- Override background color with inline styles -->
<style>
  .hljs {
    background: #151515 !important; /* Replace with your desired background color */
    border: 1px solid #444; /* Gray border */
    border-radius: 8px; /* Rounded corners */
    padding: 10px; /* Optional: Add some padding for better readability */
  }

  .hljs-ln-numbers {
    text-align: right !important;
    padding-right: 5px !important;
    user-select: none !important;
    opacity: 0.5 !important;
}

.hljs-ln-code {
    padding-left: 5px !important;
}
</style>

<script type="text/x-mathjax-config">
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\(', '\)']],
      displayMath: [['$$', '$$'], ['\[', '\]']]
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
  };
</script>
<script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/mustafa.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <h1 class="site-title">
      <a href="/">Mustafa Alotbah's Blog</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">A Computer Science dedicated blog.</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/mustafaalotbah"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['mustafa.alotbah','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
      

      
        <a
          href="https://www.linkedin.com/in/alotbah"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-linkedin"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>C++20 - Coroutines</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->





<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>C++20 - Coroutines</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1705955640"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jan 22, 2024
</time>

      </span>

      <!-- lastmod date -->
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://github.com/mustafaalotbah">Mustafa Alotbah</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="3599 words"
>
  <em>19 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  <div class="content">
    <p>Coroutines, introduced in C++20, bring a powerful mechanism for handling asynchronous operations, generators and cooperative multitasking.
Unlike conventional functions, which execute sequentially from start to return, coroutines are functions that can suspend and resume execution at specific points, effectively allowing you to pause execution, yield results, and return control to the caller without fully exiting the function.</p>

<h2 id="introduction">1. <span class="me-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>At their core, coroutines empower <em>cooperative multitasking</em> by enabling a function to be <em>suspended</em> and later <em>resumed</em> without losing its state.
This is in contrast to <em>preemptive multitasking</em>â€”such as that implemented with threadsâ€”where the operating system arbitrarily decides when to suspend a task and switch context.
Coroutines, by contrast, give the programmer explicit control over when and where to suspend or resume execution, making them a lighter and more efficient alternative for certain asynchronous programming patterns.</p>

<p>When a coroutine is called, it doesnâ€™t run to completion immediately. Instead, it returns a special object, typically referred to as a <em>coroutine handle</em>, which the caller can use to resume or finalize the coroutineâ€™s execution. This behavior introduces a level of flexibility and control that traditional functions simply do not possess.</p>

<p>Coroutines can be applied across a wide range of use cases, including:</p>

<ul>
  <li>
    <p><strong>Asynchronous I/O</strong>:</p>

    <p>Efficiently suspending operations until data becomes available from a network or file system, avoiding costly thread blocking.</p>
  </li>
  <li>
    <p><strong>Event-driven systems</strong>:</p>

    <p>Enabling highly responsive applications by reacting to incoming events without halting the system, while simultaneously maintaining clarity in control flow.</p>
  </li>
  <li>
    <p><strong>Lazy data generation</strong>:</p>

    <p>Producing data incrementally, without needing to allocate or compute the entire sequence at once, thus optimizing memory and computation resources.</p>
  </li>
</ul>

<h2 id="objective">2. <span class="me-2">Objective</span><a href="#objective" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>In this article, we will implement a simple generator-like coroutine that produces a sequence of integers, yielding values incrementally as they are requested. Consider the following example:</p>

<pre><code class="language-cpp">int main() {

    // Create the coroutine to count from 1 to 5
    Generator counter = simple_counter(1, 5);  

    // Iterate through the yielded values
    while (counter.next()) {

        // Output each yielded value
        std::cout &lt;&lt; counter.get() &lt;&lt; " ";  
    }

    std::cout &lt;&lt; std::endl;
    return 0;
}
</code></pre>

<p>The expected output for this program would be:</p>

<pre><code class="language-txt">1 2 3 4 5
</code></pre>

<p>The primary coroutine function we aim to implement is a generator that yields consecutive integers between a given start and end value:</p>

<pre><code class="language-cpp">// Coroutine function that yields consecutive numbers
Generator simple_counter(int start, int end) {
    for (int i = start; i &lt;= end; ++i) {
        // yield the current value
        co_yield i;
    }
}
</code></pre>

<p>In the code above, <code class="language-plaintext highlighter-rouge">co_yield</code> is the key operator introduced by C++20 coroutines. When encountered, it pauses the execution of the coroutine and returns a value to the caller. The coroutine can then be resumed from this point, maintaining the state of local variables.</p>

<p>Letâ€™s break down the essential components involved in making this coroutine functional and efficient in C++20.</p>

<h2 id="formal-definition">3. <span class="me-2">Formal Definition</span><a href="#formal-definition" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>In C++20, coroutines are implemented under the hood as a <strong>finite state machine (FSM)</strong>â€”a widely-recognized computational model where the system resides in one of a finite number of states at any given time and transitions between states occur based on events. For coroutines, these transitions involve saving the current state of execution and potentially performing actions such as yielding a value or suspending execution. This FSM model is particularly well-suited for coroutines, as they are designed to pause, yield results, and resume at precise points during their execution.</p>

<p>A coroutineâ€™s state persists across suspension points, enabling the function to resume from exactly where it was last paused upon the next invocation. Control over these state transitions in C++20 coroutines is achieved through three key operations:</p>

<ul>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">co_yield</code></strong>:</p>

    <p>The <code class="language-plaintext highlighter-rouge">co_yield</code> operator suspends the coroutine while yielding a value back to the caller. It also allows a coroutine to generate a sequence of values over multiple suspensions, maintaining its state between yields. This makes it highly suitable for generator-style coroutines, where values are produced incrementally.</p>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">co_return</code></strong>:</p>

    <p>The <code class="language-plaintext highlighter-rouge">co_return</code> statement signals the completion of the coroutine, returning a final value. Once a coroutine encounters <code class="language-plaintext highlighter-rouge">co_return</code>, it cannot be resumed, and the coroutineâ€™s lifetime ends.</p>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">co_await</code></strong>:</p>

    <p>The <code class="language-plaintext highlighter-rouge">co_await</code> operator suspends the coroutine, handing control back to the caller, until a specific conditionâ€”typically represented as an asynchronous eventâ€”is met. When the awaited condition is fulfilled, the coroutine resumes execution at the point where it was suspended. The type of object that is awaited must conform to the <strong>Awaitable</strong> concept, which means it must provide the following methods:</p>

    <ol>
      <li><code class="language-plaintext highlighter-rouge">await_ready()</code>: Determines if the operation is ready to proceed or if it needs to suspend.</li>
      <li><code class="language-plaintext highlighter-rouge">await_suspend()</code>: Suspends the coroutine and potentially schedules it to be resumed later.</li>
    </ol>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">await_resume()</code>: Returns the result of the awaited operation when the coroutine is resumed.</p>
  </li>
</ul>

<h3 id="state-transitions-in-coroutines">3.1. <span class="me-2">State Transitions in Coroutines</span><a href="#state-transitions-in-coroutines" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>The execution of a coroutine is driven by state transitions, which are managed by the <code class="language-plaintext highlighter-rouge">co_await</code>, <code class="language-plaintext highlighter-rouge">co_yield</code>, and <code class="language-plaintext highlighter-rouge">co_return</code> operations. These transitions occur between the following states:</p>

<ol>
  <li>
    <p><strong>Initial State</strong>:
 When a coroutine is first called, it enters the initial state. At this point, the function <code class="language-plaintext highlighter-rouge">promise_type::initial_suspend()</code> decides whether the coroutine should immediately suspend or continue execution. This gives the developer control over whether the coroutine begins running immediately or waits to be explicitly resumed.</p>
  </li>
  <li>
    <p><strong>Running State</strong>:<br />
 Once execution begins, the coroutine proceeds normally until it encounters a suspension point, such as a <code class="language-plaintext highlighter-rouge">co_await</code> or <code class="language-plaintext highlighter-rouge">co_yield</code>. Upon reaching these points, it returns control to the caller and moves into the suspended state.</p>
  </li>
  <li>
    <p><strong>Suspended State</strong>:<br />
 While suspended, the coroutineâ€™s execution contextâ€”including its local variables and call stackâ€”is preserved. At any point, the coroutine can be resumed, at which point it continues execution from the last suspension point, progressing toward its next suspension or completion.</p>
  </li>
  <li>
    <p><strong>Final State</strong>:<br />
 After the coroutine encounters a <code class="language-plaintext highlighter-rouge">co_return</code>, it enters the final state, indicating the completion of its execution. The function <code class="language-plaintext highlighter-rouge">promise_type::final_suspend()</code> ensures that no further actions can be taken on the coroutine once it has reached this point, allowing for proper cleanup and termination.</p>
  </li>
</ol>

<p>These operations and state transitions make it easier to manage asynchronous workflows, allowing for clear and efficient state management while maintaining a straightforward control flow. By combining these with custom <code class="language-plaintext highlighter-rouge">promise_type</code> objects and <code class="language-plaintext highlighter-rouge">awaitable</code> objects, C++20 coroutines offer a powerful abstraction for managing both synchronous and asynchronous tasks.</p>

<h3 id="lifecycle-of-a-coroutine">3.2. <span class="me-2">Lifecycle of a Coroutine</span><a href="#lifecycle-of-a-coroutine" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>The lifecycle of a coroutine is intricately managed by these state transitions. The following diagram captures the transitions and operations:</p>

<pre><code class="language-mermaid">stateDiagram-v2
    %% Starting point
    [*] --&gt; InitialState
    InitialState: Initial State

    %% Transition to Running or Suspended State based on initial_suspend()
    InitialState --&gt; RunningState: coroutine called
    InitialState --&gt; SuspendedState: initial_suspend()

    %% Running State
    RunningState: Running State
    RunningState --&gt; SuspendedState: co_await / co_yield
    RunningState --&gt; FinalState: co_return

    %% Suspended State
    SuspendedState: Suspended State
    SuspendedState --&gt; RunningState: resume()
    SuspendedState --&gt; FinalState: co_return / Scope End

    %% Final State
    FinalState: Final State
    FinalState: final_suspend()
</code></pre>

<p>By explicitly controlling state transitions, C++20 coroutines provide a structured, efficient mechanism for managing asynchronous workflows. Unlike traditional multithreading, where the operating system handles preemptive task switching, coroutines give the programmer direct control over suspensions and resumptions, leading to a more predictable and performant system. Moreover, the use of <code class="language-plaintext highlighter-rouge">promise_type</code> and <code class="language-plaintext highlighter-rouge">awaitable</code> objects allows developers to customize the behavior of coroutines, providing fine-grained control over both synchronous and asynchronous tasks.</p>

<h2 id="implementing-the-coroutine">4. <span class="me-2">Implementing the Coroutine</span><a href="#implementing-the-coroutine" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>In order to employ the <code class="language-plaintext highlighter-rouge">co_yield</code> operator within a function, the return type must conform to the <strong>coroutine</strong> <strong>concept</strong> as defined by the C++20 standard. When the compiler detects the presence of keywords like <code class="language-plaintext highlighter-rouge">co_yield</code>, <code class="language-plaintext highlighter-rouge">co_await</code>, or <code class="language-plaintext highlighter-rouge">co_return</code>, it automatically flags the function as a coroutine, which fundamentally changes its behavior.</p>

<p>Instead of following the conventional function model of entering, executing, and exiting, coroutines return an intermediate object (e.g. <code class="language-plaintext highlighter-rouge">Generator</code>) that encapsulates their state and enables suspension and resumption of execution. This returned object serves as the interface through which the coroutine interacts with the calling environment.</p>

<p>In our example, the coroutine will return an object of type <code class="language-plaintext highlighter-rouge">Generator</code>, which will function as a generator of integers. To fulfill the coroutineâ€™s requirements and the compilerâ€™s expectations, we need to define a corresponding generator class, <code class="language-plaintext highlighter-rouge">Generator</code>, that adheres to the coroutine concept. At the core of this concept lies the <code class="language-plaintext highlighter-rouge">promise_type</code>, a structure that mediates between the caller and the coroutine, orchestrating the coroutineâ€™s lifecycle, including suspension, resumption, and finalization.</p>

<p>Below is the skeletal structure of our generator <code class="language-plaintext highlighter-rouge">Generator</code>, which we will expand to implement the necessary coroutine mechanisms:</p>

<pre><code class="language-cpp">class Generator {
    // Required by the compiler to control the coroutine
    struct promise_type;  

    // constructor
    Generator(std::coroutine_handle&lt;promise_type&gt; handle);   

private: 
    // Handle to control coroutine execution
    std::coroutine_handle&lt;promise_type&gt; coroutine_handle_; 
}
</code></pre>

<h3 id="the-heart-of-coroutines-promise_type">4.1. <span class="me-2">The Heart of Coroutines: promise_type</span><a href="#the-heart-of-coroutines-promise_type" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>The <code class="language-plaintext highlighter-rouge">promise_type</code> structure is the core component in C++20 coroutines, responsible for managing the coroutineâ€™s internal state and interacting with the calling code. Whenever a coroutine is invoked, the compiler generates an instance of the <code class="language-plaintext highlighter-rouge">promise_type</code>. The <code class="language-plaintext highlighter-rouge">promise_type</code> interface defines how the coroutine behaves at each phase of its execution, including initial suspension, resumption, final suspension, and error handling.</p>

<p>The <code class="language-plaintext highlighter-rouge">promise_type</code> must provide the following methods to manage coroutine state transitions:</p>

<pre><code class="language-cpp">struct promise_type {
    // Returns the object that the coroutine will hand back to the caller
    Generator get_return_object();

    // Suspend execution immediately after starting
    std::suspend_always initial_suspend();

    // Suspend execution after the coroutine is done
    std::suspend_always final_suspend() noexcept;

    // Handle any exceptions that occur within the coroutine
    void unhandled_exception();
};
</code></pre>

<p>Key methods that must be implemented in <code class="language-plaintext highlighter-rouge">promise_type</code> include:</p>

<ul>
  <li>
    <ol>
      <li><strong><code class="language-plaintext highlighter-rouge">Generator get_return_object()</code></strong>:<br />
  This method returns the object that will represent the coroutineâ€™s execution state to the caller. It is called as soon as the coroutine is instantiated. In the case of a generator, it returns a handle to the coroutine itself, allowing the caller to resume or query the coroutineâ€™s state.</li>
    </ol>

    <p>The typical implementation for this method is as follows:</p>

    <pre><code class="language-cpp">  Generator Generator::promise_type::get_return_object()  
  {
      // The coroutine_handle manages the lifetime and resumption of the coroutine
      return Generator{std::coroutine_handle&lt;promise_type&gt;::from_promise(*this)};  
  }
</code></pre>

    <p>Here, the <code class="language-plaintext highlighter-rouge">from_promise()</code> function creates a coroutine handle that ties the <code class="language-plaintext highlighter-rouge">promise_type</code> to the coroutine object, providing the caller with full control over the coroutineâ€™s lifecycle.</p>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">std::suspend_always initial_suspend()</code></strong>:<br />
  This method determines whether the coroutine should suspend execution immediately upon creation. The return type must satisfy the <strong>awaitable</strong> concept, which determines how the coroutine behaves at suspension points. Returning <code class="language-plaintext highlighter-rouge">std::suspend_always</code> ensures that the coroutine will suspend after being invoked, giving the caller control over when to resume execution.</p>

    <p>Example implementation:</p>

    <pre><code class="language-cpp">  std::suspend_always Generator::promise_type::initial_suspend()  
  {  
      // The coroutine starts in a suspended state and must be resumed explicitly
      return {};  
  }
</code></pre>

    <p>In this case, we return <code class="language-plaintext highlighter-rouge">std::suspend_always</code>, indicating that the coroutine suspends right after its invocation, awaiting an explicit resume action.</p>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">std::suspend_always final_suspend()</code></strong>:<br />
  This method is called when the coroutine reaches its end, either through a <code class="language-plaintext highlighter-rouge">co_return</code> or because the function runs to completion. It determines whether the coroutine should suspend before final cleanup or exit immediately. The typical pattern is to use <code class="language-plaintext highlighter-rouge">std::suspend_always</code> to ensure that the caller has an opportunity to finalize any resources tied to the coroutine handle.</p>

    <p>Example:</p>

    <pre><code class="language-cpp">  std::suspend_always Generator::promise_type::final_suspend()  
  {  
      // After the coroutine is done, it suspends one last time before being destroyed
      return {};  
  }
</code></pre>

    <p>This final suspension is a key point in the coroutineâ€™s lifecycle, giving the caller a chance to perform any necessary cleanup or synchronizing actions.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">void unhandled_exception()</code></p>

    <p>This method defines the coroutineâ€™s behavior when an exception is thrown inside the coroutine body and not explicitly handled. The most common implementation involves terminating the program, but more advanced handlers could log the error or propagate the exception to the caller.</p>

    <p>Example implementation:</p>

    <pre><code class="language-cpp">  void Generator::promise_type::unhandled_exception()  
  {  
      // Terminate the program or just log an error and freeze the coroutine
      std::terminate();  
  }
</code></pre>

    <p>In this basic implementation, <code class="language-plaintext highlighter-rouge">std::terminate()</code> is called to halt the program when an unhandled exception occurs within the coroutine. More advanced coroutine systems may instead propagate exceptions back to the caller.</p>
  </li>
</ul>

<h3 id="the-awaitable-concept">4.2. <span class="me-2">The Awaitable Concept</span><a href="#the-awaitable-concept" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>The <strong>awaitable</strong> concept in C++ defines a set of rules for objects that can be used in conjunction with <code class="language-plaintext highlighter-rouge">co_await</code>. These objects determine whether a coroutine should suspend, what happens when it suspends, and how the coroutine resumes. In the context of coroutines, both <code class="language-plaintext highlighter-rouge">std::suspend_always</code> and <code class="language-plaintext highlighter-rouge">std::suspend_never</code> are common awaitables that provide predefined behavior for suspension.</p>

<ul>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">std::suspend_always</code></strong>:<br />
  This is an awaitable that always suspends the coroutine. It is used when the coroutine should explicitly suspend, allowing the caller to determine when to resume it.</p>

    <pre><code class="language-cpp">  struct std::suspend_always {
      bool await_ready() const noexcept { return false; }
      void await_suspend(std::coroutine_handle&lt;&gt;) const noexcept {}
      void await_resume() const noexcept {}
  };
</code></pre>

    <ul>
      <li><code class="language-plaintext highlighter-rouge">await_ready()</code>: Returns <code class="language-plaintext highlighter-rouge">false</code>, indicating that the coroutine should suspend.</li>
      <li><code class="language-plaintext highlighter-rouge">await_suspend()</code>: Performs the actual suspension.</li>
      <li><code class="language-plaintext highlighter-rouge">await_resume()</code>: Defines what happens when the coroutine resumes.</li>
    </ul>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">std::suspend_never</code></strong>:<br />
  This awaitable ensures that the coroutine never suspends at a particular suspension point, allowing it to continue execution without interruption.</p>

    <pre><code class="language-cpp">  struct std::suspend_never {
      bool await_ready() const noexcept { return true; }
      void await_suspend(std::coroutine_handle&lt;&gt;) const noexcept {}
      void await_resume() const noexcept {}
  };
</code></pre>

    <ul>
      <li><code class="language-plaintext highlighter-rouge">await_ready()</code>: Returns <code class="language-plaintext highlighter-rouge">true</code>, meaning the coroutine does not suspend.</li>
      <li><code class="language-plaintext highlighter-rouge">await_suspend()</code> and <code class="language-plaintext highlighter-rouge">await_resume()</code> are no-ops, as no suspension occurs.</li>
    </ul>
  </li>
</ul>

<h3 id="coroutine-operators">4.3. <span class="me-2">Coroutine Operators</span><a href="#coroutine-operators" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>In C++20, coroutines utilize specialized operators (<code class="language-plaintext highlighter-rouge">co_await</code>, <code class="language-plaintext highlighter-rouge">co_yield</code>, and <code class="language-plaintext highlighter-rouge">co_return</code>) to manage control flow, yielding values, awaiting asynchronous events, or signaling coroutine completion. For a coroutine to function correctly, it must overload and implement at least one of these operators. The choice of the operator depends on the desired behaviorâ€”whether the coroutine should suspend while awaiting, yield intermediate results, or complete execution and return a value.</p>

<h4 id="the-operator-co_yield">4.3.1. <span class="me-2">The Operator co_yield</span><a href="#the-operator-co_yield" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>The <code class="language-plaintext highlighter-rouge">co_yield</code> operator facilitates the suspension of the coroutine, returning control to the caller while also passing back a value.
To overload this operator, the <code class="language-plaintext highlighter-rouge">promise_type</code> structure must implement at least one of two forms of <code class="language-plaintext highlighter-rouge">yield_value</code>:  <code class="language-plaintext highlighter-rouge">awaitable yield_value(T)</code> or <code class="language-plaintext highlighter-rouge">awaitable yield_void()</code>.</p>

<pre><code class="language-cpp">struct promise_type {
    Generator get_return_object();
    std::suspend_always initial_suspend();
    std::suspend_always final_suspend() noexcept;
    void unhandled_exception();

    // Overload for yielding an integer value (e.g., `co_yield 5;`)
    std::suspend_always yield_value(int val);

    // Overload for yielding a string value (e.g., `co_yield "Hello";`)
    std::suspend_always yield_value(std::string val);

    // Yielding control without passing a value (e.g., `co_yield;`)
    std::suspend_always yield_void();
};
</code></pre>

<p>In the context of a generator design like <code class="language-plaintext highlighter-rouge">Generator</code>, the <code class="language-plaintext highlighter-rouge">yield_value</code> function is used to store or update the coroutineâ€™s internal state (<code class="language-plaintext highlighter-rouge">current_value</code>), which the user can later retrieve. However, coroutines are much more powerful and can solve more complex control flow problems than simple generators.</p>

<ul>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">awaitable yield_value(T)</code></strong>:</p>

    <p>This method is invoked when <code class="language-plaintext highlighter-rouge">co_yield</code> is used in the coroutine. It suspends the coroutine and yields the value <code class="language-plaintext highlighter-rouge">T</code> to the caller. At this suspension point, the state of the coroutine is preserved, allowing it to resume at a later time. The caller can retrieve the yielded value after resumption.</p>

    <p>Example implementation:</p>

    <pre><code class="language-cpp">  std::suspend_always promise_type::yield_value(int value) {
      value_ = value;  // Store the yielded value in the internal state
      return {};       // Suspend the coroutine
  }
</code></pre>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">awaitable yield_void()</code></strong>:</p>

    <p>This method is called when the coroutine is suspended without yielding a specific value to the caller. It can be used when the coroutine needs to pause execution but doesnâ€™t produce an output. This operator is less common in generator-style coroutines but can be useful in control flow scenarios.</p>

    <p>Example:</p>

    <pre><code class="language-cpp">  std::suspend_always promise_type::yield_void() {
      // Suspend the coroutine without yielding a value
      return {};
  }
</code></pre>
  </li>
</ul>

<p>Hence for our <code class="language-plaintext highlighter-rouge">Generator</code> example, we could define</p>

<pre><code class="language-cpp">class Generator  
{  
 public:
    struct promise_type  
    { 
     public:  
        Generator get_return_object();  
        std::suspend_always initial_suspend();  
        std::suspend_always final_suspend() noexcept;   
        void unhandled_exception();  
    
        // Overload co_yield, 
        std::suspend_always yield_value(int val);
     public:
        friend class Generator;
        int value_{ 0 };  
    };

    // type alias to reduce code
    using handle_type = std::coroutine_handle&lt;promise_type&gt;;  

private:
    handle_type coroutine_handle_;
}
</code></pre>

<h4 id="the-operator-co_return">4.3.2. <span class="me-2">The Operator co_return</span><a href="#the-operator-co_return" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>The <code class="language-plaintext highlighter-rouge">co_return</code> operator signals the end of a coroutine and allows the coroutine to return a value to the caller. The <code class="language-plaintext highlighter-rouge">promise_type</code> must implement <code class="language-plaintext highlighter-rouge">return_value(T)</code> or <code class="language-plaintext highlighter-rouge">return_void()</code> to overload this operator.</p>

<p>Example:</p>

<pre><code class="language-cpp">struct promise_type {
    Generator get_return_object();
    std::suspend_always initial_suspend();
    std::suspend_always final_suspend() noexcept;
    void unhandled_exception();

    // Return an integer value upon coroutine completion (e.g., `co_return 42;`)
    std::suspend_always return_value(int val);

    // Return a string upon coroutine completion (e.g., `co_return "Done";`)
    std::suspend_always return_value(std::string val);

    // Signal coroutine completion without returning a value (e.g., `co_return;`)
    std::suspend_always return_void();
};
</code></pre>

<p>In the <code class="language-plaintext highlighter-rouge">Generator</code> example, we could overload the <code class="language-plaintext highlighter-rouge">return_value</code> and <code class="language-plaintext highlighter-rouge">return_void</code> operators to handle final results or simply to indicate that the coroutine has completed its execution.</p>

<ul>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">awaitable return_value(T)</code></strong>:</p>

    <p>This method is called when <code class="language-plaintext highlighter-rouge">co_return</code> is used in the coroutine, allowing the coroutine to return a final value to the caller. It suspends the coroutine, signals completion, and passes the return value back to the caller.</p>

    <pre><code class="language-cpp">  std::suspend_always Generator::promise_type::return_value(int val) {
      value_ = val;  // Store the final returned value
      return {};     // Suspend the coroutine before finalization
  }
</code></pre>

    <p>In this example, the <code class="language-plaintext highlighter-rouge">return_value</code> method stores the value passed to <code class="language-plaintext highlighter-rouge">co_return</code> in the <code class="language-plaintext highlighter-rouge">value_</code> field of the <code class="language-plaintext highlighter-rouge">promise_type</code>. The coroutine is then suspended one last time, allowing the caller to retrieve the value before the coroutine is destroyed.</p>

    <p>Usage in a coroutine:</p>

    <pre><code class="language-cpp">  Generator simple_counter(int start, int end) {
      for (int i = start; i &lt;= end; ++i) {
          co_yield i;
      }
      // Return a final result after the loop completes
      co_return end + 1;  
  }
</code></pre>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">awaitable return_void()</code></strong>:</p>

    <p>This method is invoked when <code class="language-plaintext highlighter-rouge">co_return</code> is used without a value, simply marking the coroutine as complete and suspending it for final cleanup. This is useful when the coroutineâ€™s task is done, and no final value needs to be returned. After calling <code class="language-plaintext highlighter-rouge">return_void()</code>, the coroutine transitions to its final suspended state and is then cleaned up.</p>

    <pre><code class="language-cpp">  std::suspend_always promise_type::yield_void() {
      // Suspend the coroutine without yielding a value
      return {};
  }
</code></pre>

    <p>In this case, the coroutine finishes without yielding or returning any specific value. The final suspension allows the coroutineâ€™s resources to be cleaned up in an orderly fashion.</p>

    <p>Usage in a coroutine:</p>

    <pre><code class="language-cpp">  Generator simple_counter(int start, int end) {
      for (int i = start; i &lt;= end; ++i) {
          co_yield i;
      }
      // End the coroutine without returning a value
      co_return;
  }
</code></pre>
  </li>
</ul>

<h3 id="managing-the-coroutine-handle">4.4. <span class="me-2">Managing the Coroutine Handle</span><a href="#managing-the-coroutine-handle" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>In the above implementation, we leverage <code class="language-plaintext highlighter-rouge">std::coroutine_handle</code> to manage the lifecycle of the coroutine. This handle acts as a lightweight wrapper that directly interfaces with the coroutine, allowing control over its execution. The handle is essential for interacting with the coroutine at various stagesâ€”suspension, resumption, finalization, and cleanup.</p>

<p>Here is a more detailed explanation of the key functions of <code class="language-plaintext highlighter-rouge">std::coroutine_handle</code> utilized in our <code class="language-plaintext highlighter-rouge">Generator</code> example:</p>

<ol>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">void destroy()</code></strong>:<br />
 The <code class="language-plaintext highlighter-rouge">destroy()</code> method is used to explicitly destroy the coroutine. It ensures that once the coroutine has completed its execution, its resources are properly cleaned up, preventing memory leaks. In our <code class="language-plaintext highlighter-rouge">Generator</code> class, we call <code class="language-plaintext highlighter-rouge">destroy()</code> within the destructor, ensuring that if the coroutine is still alive, it gets terminated and cleaned up before the <code class="language-plaintext highlighter-rouge">Generator</code> object goes out of scope.</p>

    <p>Example usage in the destructor:</p>

    <pre><code class="language-cpp"> Generator::~Generator() {
     // Clean up coroutine resources
     if (coroutine_handle_) coroutine_handle_.destroy();  
 }
</code></pre>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">void resume()</code></strong>:<br />
 The <code class="language-plaintext highlighter-rouge">resume()</code> method allows the coroutine to proceed from its last suspension point. This is used within the <code class="language-plaintext highlighter-rouge">next()</code> function, which resumes the coroutine and attempts to move it to the next <code class="language-plaintext highlighter-rouge">co_yield</code> or <code class="language-plaintext highlighter-rouge">co_return</code>. By invoking <code class="language-plaintext highlighter-rouge">resume()</code>, the coroutineâ€™s execution is continued until it either reaches another suspension point or completes execution.</p>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">bool done()</code></strong>:<br />
 The <code class="language-plaintext highlighter-rouge">done()</code> method checks whether the coroutine has reached its final state and is no longer resumable. It returns <code class="language-plaintext highlighter-rouge">true</code> if the coroutine has completed execution. This is important for ensuring that the coroutine is not resumed after it has finished. In the <code class="language-plaintext highlighter-rouge">next()</code> function, <code class="language-plaintext highlighter-rouge">done()</code> is checked both before and after calling <code class="language-plaintext highlighter-rouge">resume()</code> to ensure that the coroutine is still active.</p>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">promise_type&amp; promise()</code></strong>:<br />
 The <code class="language-plaintext highlighter-rouge">promise()</code> method provides access to the <code class="language-plaintext highlighter-rouge">promise_type</code> instance associated with the coroutine. This is crucial because the <code class="language-plaintext highlighter-rouge">promise_type</code> holds the internal state of the coroutine, including the value that was last yielded or returned. The <code class="language-plaintext highlighter-rouge">promise()</code> method is used in the <code class="language-plaintext highlighter-rouge">get()</code> function to retrieve the current value yielded by the coroutine.</p>
  </li>
</ol>

<h3 id="retrieving-values-in-the-generator">4.5. <span class="me-2">Retrieving Values in the Generator</span><a href="#retrieving-values-in-the-generator" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>To allow interaction between the <code class="language-plaintext highlighter-rouge">Generator</code> generator and the caller, we need two essential methods:</p>

<ul>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">bool next()</code></strong>: This method continues the execution of the coroutine until it suspends again, either due to a <code class="language-plaintext highlighter-rouge">co_yield</code> or <code class="language-plaintext highlighter-rouge">co_return</code>. It checks if the coroutine is done, resumes execution, and returns whether the coroutine has yielded a new value. If the coroutine has completed execution, it returns <code class="language-plaintext highlighter-rouge">false</code>.</p>

    <p>Full implementation:</p>

    <pre><code class="language-cpp">  bool Generator::next() const  
  {  
     if (!coroutine_handle_ || coroutine_handle_.done()) return false;  

     // Resume the coroutine  
     coroutine_handle_.resume();  

     // Check again if it's done after resuming  
     return !coroutine_handle_.done();
  }
</code></pre>

    <p>Before resuming the coroutine, we first ensure that the coroutine handle is properly initialized and that the coroutine has not already completed its execution. This is accomplished by checking if the handle is valid and if the coroutine is not in the <em>done</em> state.</p>

    <p>Once confirmed, we can safely invoke the <code class="language-plaintext highlighter-rouge">resume()</code> method to move the coroutine forward to its next suspension point. The use of <code class="language-plaintext highlighter-rouge">co_yield</code> within the coroutine may return a value and suspend execution at multiple points before the function fully completes. After calling <code class="language-plaintext highlighter-rouge">resume()</code>, it is essential to check again whether the coroutine has reached its final state by invoking <code class="language-plaintext highlighter-rouge">done()</code>.</p>

    <p>If the resumption of the coroutine leads to its termination without yielding any additional values, we return <code class="language-plaintext highlighter-rouge">false</code>, indicating that the coroutine has completed its task. This prevents further attempts to resume a completed coroutine.</p>

    <p>However, if we employ <code class="language-plaintext highlighter-rouge">co_return</code> at the end of the coroutine, and it results in a final value being returned, we would return <code class="language-plaintext highlighter-rouge">true</code>, as this indicates that the coroutine has successfully yielded a value before reaching its conclusion. In this case, the caller can retrieve the final value using the <code class="language-plaintext highlighter-rouge">get()</code> method.</p>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">int get()</code></strong>: This method retrieves the current value yielded by the coroutine. It accesses the <code class="language-plaintext highlighter-rouge">promise_type</code> through the coroutine handle to fetch the stored value. This method should be called after <code class="language-plaintext highlighter-rouge">next()</code> returns <code class="language-plaintext highlighter-rouge">true</code>, indicating that the coroutine has successfully yielded a new value.
  Full implementation:</p>

    <pre><code class="language-cpp">  int Generator::get() const  
  {  
      return coroutine_handle_.promise().value_;  
  }
</code></pre>

    <p>Here, the method accesses the <code class="language-plaintext highlighter-rouge">promise_type</code> instance via the <code class="language-plaintext highlighter-rouge">coroutine_handle_</code>, fetching the <code class="language-plaintext highlighter-rouge">value_</code> field, which stores the value yielded during the last <code class="language-plaintext highlighter-rouge">co_yield</code> or <code class="language-plaintext highlighter-rouge">co_return</code>.</p>
  </li>
</ul>

<!-- TODO: co_wait, unhandled_exception, Asynchronous Example, Event-based systems -->

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/software-development/">Software-Development</a>,
          <a href="/categories/c/">C++</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/software/"
            class="post-tag no-text-decoration"
          >Software</a>
        
          <a
            href="/tags/c/"
            class="post-tag no-text-decoration"
          >C++</a>
        
          <a
            href="/tags/c-20/"
            class="post-tag no-text-decoration"
          >C++20</a>
        
          <a
            href="/tags/software/"
            class="post-tag no-text-decoration"
          >Software</a>
        
          <a
            href="/tags/designs/"
            class="post-tag no-text-decoration"
          >Designs</a>
        
          <a
            href="/tags/generator/"
            class="post-tag no-text-decoration"
          >Generator</a>
        
          <a
            href="/tags/coroutine/"
            class="post-tag no-text-decoration"
          >Coroutine</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/CPP-Coroutines/">C++20 - Coroutines</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Exploring-Exception-Handling-Mechanisms-in-Embedded-Environments/">Efficient Exception Handling in Resource-Constrained Embedded Systems</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/CMake-Production/">CMake - Publish Your Own Library</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/CMake-Integrating-C++-Libraries/">CMake - Integrating C++ Libraries</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/CMake-On-Windows/">CMake - Installation On Windows</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/c/">C++</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/software/">Software</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cmake/">Cmake</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/windows/">Windows</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/arm/">ARM</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/embedded/">Embedded</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/stm32/">STM32</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/blackpill/">blackpill</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/build-systems/">Build-Systems</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/c-20/">C++20</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="d-none ps-0 pe-4">
    <h2 class="panel-heading ps-3 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    










  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/CMake-Production/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1700308800"
  data-df="ll"
  
>
  Nov 18, 2023
</time>

              <h4 class="pt-0 my-2">4.5.1. CMake - Publish Your Own Library</h4>
              <div class="text-muted">
                <p>Introduction to Publishing CMake Projects

When developing a C++ library, especially one meant to be reused across multiple projects or distributed to others, itâ€™s crucial to structure your project...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/CMake-Integrating-C++-Libraries/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1700064480"
  data-df="ll"
  
>
  Nov 15, 2023
</time>

              <h4 class="pt-0 my-2">4.5.2. CMake - Integrating C++ Libraries</h4>
              <div class="text-muted">
                <p>In modern C++ development, CMake is an indispensable tool for managing project dependencies.
This comprehensive guide empowers you to effortlessly integrate widely used C++ libraries into your proj...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/CMake-On-Windows/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1695133080"
  data-df="ll"
  
>
  Sep 19, 2023
</time>

              <h4 class="pt-0 my-2">4.5.3. CMake - Installation On Windows</h4>
              <div class="text-muted">
                <p>Here is a quick way to get started into development with CMake on Windows x64.

Getting Started

Downloads


  Download MinGW64 (posix, seh, msvcrt) fromÂ here.
  Download CMake (Windows x64) from h...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/Exploring-Exception-Handling-Mechanisms-in-Embedded-Environments/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Efficient Exception Handling in Resource-Constrained Embedded Systems</p>
    </a>
  

  
    <div class="btn btn-outline-primary disabled" aria-label="Newer">
      <p>-</p>
    </div>
  
</nav>

            
              
              <!-- The comments switcher -->


            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>Â©
    <time>2024</time>

    
      <a href="https://github.com/mustafaalotbah">Mustafa Alotbah</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.0.1"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/c/">C++</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/software/">Software</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cmake/">Cmake</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/windows/">Windows</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/arm/">ARM</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/embedded/">Embedded</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/stm32/">STM32</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/blackpill/">blackpill</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/build-systems/">Build-Systems</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/c-20/">C++20</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->
    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->




  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.11/dayjs.min.js,npm/dayjs@1.11.11/locale/en.min.js,npm/dayjs@1.11.11/plugin/relativeTime.min.js,npm/dayjs@1.11.11/plugin/localizedFormat.min.js,npm/tocbot@4.27.20/dist/tocbot.min.js,npm/mermaid@10.9.0/dist/mermaid.min.js"></script>






<script src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  <!-- mermaid-js loader -->
<script type="text/javascript">
  function updateMermaid(event) {
    if (event.source === window && event.data && event.data.direction === ModeToggle.ID) {
      const mode = event.data.message;

      if (typeof mermaid === 'undefined') {
        return;
      }

      let expectedTheme = mode === ModeToggle.DARK_MODE ? 'dark' : 'default';
      let config = { theme: expectedTheme };const mermaidList = document.getElementsByClassName('mermaid');

      [...mermaidList].forEach((elem) => {
        const svgCode = elem.previousSibling.children.item(0).innerHTML;
        elem.innerHTML = svgCode;
        elem.removeAttribute('data-processed');
      });

      mermaid.initialize(config);
      mermaid.init(undefined, '.mermaid');
    }
  }

  (function () {
    let initTheme = 'default';
    const html = document.documentElement;

    if (
      (html.hasAttribute('data-mode') && html.getAttribute('data-mode') === 'dark') ||
      (!html.hasAttribute('data-mode') && window.matchMedia('(prefers-color-scheme: dark)').matches)
    ) {
      initTheme = 'dark';
    }

    let mermaidConf = {
      theme: initTheme};const basicList = document.getElementsByClassName('language-mermaid');
    [...basicList].forEach((elem) => {
      const svgCode = elem.textContent;
      const backup = elem.parentElement;
      backup.classList.add('d-none');let mermaid = document.createElement('pre');
      mermaid.classList.add('mermaid');
      const text = document.createTextNode(svgCode);
      mermaid.appendChild(text);
      backup.after(mermaid);
    });

    mermaid.initialize(mermaidConf);
    window.addEventListener('message', updateMermaid);
  })();
</script>






    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2>5. <a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5">Oops! No results found.</p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>


  </body>
</html>
